---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pnpm-workspace.yaml
  - package.json
  - .npmrc
  - packages/shared-types/package.json
  - packages/shared-types/src/index.ts
  - packages/eslint-config/package.json
  - packages/eslint-config/index.js
  - packages/tsconfig/package.json
  - packages/tsconfig/base.json
  - packages/tsconfig/react.json
  - packages/tsconfig/node.json
  - vitest.workspace.ts
  - .prettierrc
autonomous: true

must_haves:
  truths:
    - "pnpm install succeeds at root with no errors"
    - "TypeScript compiles across all packages"
    - "ESLint runs with shared config"
    - "Packages can import from @compliance-iq/shared-types"
  artifacts:
    - path: "pnpm-workspace.yaml"
      provides: "Workspace package discovery"
      contains: "packages:"
    - path: "packages/shared-types/package.json"
      provides: "Shared types package"
      contains: "@compliance-iq/shared-types"
    - path: "packages/tsconfig/base.json"
      provides: "Base TypeScript configuration"
      contains: "compilerOptions"
  key_links:
    - from: "apps/*/package.json"
      to: "packages/shared-types"
      via: "workspace:* protocol"
      pattern: "\"@compliance-iq/shared-types\": \"workspace:\\*\""
---

<objective>
Initialize pnpm monorepo with workspace structure and shared configuration packages.

Purpose: Establish the foundation for all Phase 1 apps (Convex, Workers, React) to share types and configuration.
Output: Working monorepo with shared-types, eslint-config, and tsconfig packages.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize pnpm monorepo with workspace structure</name>
  <files>
    pnpm-workspace.yaml
    package.json
    .npmrc
    .prettierrc
  </files>
  <action>
1. Initialize pnpm workspace at root:
   - Create `pnpm-workspace.yaml` with `packages: ['apps/*', 'packages/*']`
   - Create root `package.json` with:
     - name: "compliance-iq"
     - private: true
     - packageManager: "pnpm@10.0.0"
     - scripts: { "build": "pnpm -r build", "test": "vitest", "lint": "eslint ." }
     - devDependencies: typescript, eslint, prettier, vitest, @types/node
   - Create `.npmrc` with `shamefully-hoist=false` (strict mode)
   - Create `.prettierrc` with { "semi": true, "singleQuote": true, "trailingComma": "es5" }

2. Create directory structure:
   - `apps/` (empty, for Convex, Workers, React)
   - `packages/` (for shared packages)
   - `.github/workflows/` (for CI/CD)

3. Run `pnpm install` to verify workspace setup works
  </action>
  <verify>
    - `pnpm install` completes with exit code 0
    - `ls apps packages` shows empty directories
    - `cat pnpm-workspace.yaml` shows correct config
  </verify>
  <done>Root monorepo structure created with pnpm workspaces configured and strict mode enabled</done>
</task>

<task type="auto">
  <name>Task 2: Create shared configuration packages</name>
  <files>
    packages/shared-types/package.json
    packages/shared-types/src/index.ts
    packages/shared-types/tsconfig.json
    packages/eslint-config/package.json
    packages/eslint-config/index.js
    packages/tsconfig/package.json
    packages/tsconfig/base.json
    packages/tsconfig/react.json
    packages/tsconfig/node.json
    vitest.workspace.ts
  </files>
  <action>
1. Create `packages/shared-types/`:
   - package.json with name "@compliance-iq/shared-types", exports using custom conditions for live types:
     ```json
     {
       "name": "@compliance-iq/shared-types",
       "version": "0.1.0",
       "type": "module",
       "exports": {
         ".": {
           "import": {
             "@compliance-iq/source": "./src/index.ts",
             "default": "./dist/index.js"
           },
           "types": "./dist/index.d.ts"
         }
       },
       "scripts": { "build": "tsc" }
     }
     ```
   - tsconfig.json extending base config
   - src/index.ts with placeholder exports:
     ```typescript
     // Jurisdiction types - will be populated in future phases
     export type JurisdictionType = 'federal' | 'state' | 'county' | 'municipal';

     export interface Jurisdiction {
       id: string;
       name: string;
       type: JurisdictionType;
       stateCode?: string;
       countyFips?: string;
       cityName?: string;
     }
     ```

2. Create `packages/eslint-config/`:
   - package.json with name "@compliance-iq/eslint-config"
   - index.js exporting shared ESLint config (TypeScript + Prettier):
     ```js
     module.exports = {
       parser: '@typescript-eslint/parser',
       extends: ['plugin:@typescript-eslint/recommended', 'plugin:prettier/recommended'],
       parserOptions: { project: true },
       rules: { '@typescript-eslint/no-unused-vars': ['error', { argsIgnorePattern: '^_' }] }
     };
     ```
   - Add dependencies: @typescript-eslint/eslint-plugin, @typescript-eslint/parser, eslint-config-prettier, eslint-plugin-prettier

3. Create `packages/tsconfig/`:
   - package.json with name "@compliance-iq/tsconfig"
   - base.json with strict TypeScript settings:
     ```json
     {
       "compilerOptions": {
         "target": "ES2022",
         "module": "ESNext",
         "moduleResolution": "bundler",
         "strict": true,
         "esModuleInterop": true,
         "skipLibCheck": true,
         "declaration": true,
         "declarationMap": true,
         "customConditions": ["@compliance-iq/source"]
       }
     }
     ```
   - react.json extending base with React/JSX settings
   - node.json extending base with Node.js module settings

4. Create root `vitest.workspace.ts`:
   ```typescript
   import { defineWorkspace } from 'vitest/config';
   export default defineWorkspace(['packages/*', 'apps/*']);
   ```

5. Run `pnpm install` to link packages
  </action>
  <verify>
    - `pnpm install` succeeds
    - `pnpm -r build` completes (builds shared-types)
    - `cat packages/shared-types/package.json | grep "@compliance-iq"` shows correct name
    - `cat packages/tsconfig/base.json` shows strict mode enabled
  </verify>
  <done>Shared packages (types, eslint-config, tsconfig) created with workspace protocol and live types support</done>
</task>

</tasks>

<verification>
1. `pnpm install` at root succeeds with no errors
2. `pnpm -r build` builds all packages
3. `pnpm lint` runs (may have no files yet)
4. Workspace structure matches RESEARCH.md pattern:
   ```
   compliance-iq/
   ├── apps/
   ├── packages/
   │   ├── shared-types/
   │   ├── eslint-config/
   │   └── tsconfig/
   ├── pnpm-workspace.yaml
   └── package.json
   ```
</verification>

<success_criteria>
- pnpm workspace configured with strict mode (no phantom dependencies)
- Shared packages exist and can be referenced via `workspace:*` protocol
- TypeScript base configuration supports live types via customConditions
- ESLint and Prettier configured for code quality
- Vitest workspace ready for future tests
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
